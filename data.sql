use fur;
insert into roles(role) values 
('admin'), 
('editor'), 
('viewer'),
('student'),
('instructor'),
('guest'),
('moderator');

insert into skills(skill) values 
('JavaScript'),
('Python'),
('Java'),
('C#'),
('Ruby'),
('PHP'),
('HTML/CSS'),
('SQL'),
('NoSQL'),
('Machine Learning'),
('Data Analysis'),
('DevOps'),
('Cloud Computing'),
('Cybersecurity'),
('Mobile Development;'),
('Go'),
('Swift'),
('Kotlin'),
('Django'),
('Flask'),
('React'),
('Angular'),
('Vue.js'),
('Node.js'),
('Laravel'),
('Symfony'),
('Spring'),
('ASP.NET'),
('Rails'),
('Docker'),
('Kubernetes'),
('AWS'),
('Azure'),
('GCP'),
('TensorFlow'),
('PyTorch'),
('Pandas'),
('NumPy'),
('Jenkins'),
('Git'),
('Agile Methodologies');

insert into gender(gender) values
('Male'),
('Female'),
('Prefer not to say');

insert into users (userId, fullname, email, roleId, genderId) values
(171407, 'Walala, Derrick P. Omondi', 'walala@gmail.com', 1, 3),
(171598, 'Mwiti, Melvis Mwenda', 'Mwiti@gmail.com', 2, 3),
(171600, 'Obuki, Jesse Samuel Hawi', 'Obuki@gmail.com', 3, 3),
(172445, 'Chege, Ashley Njoki', 'Chege.Ashley@gmail.com', 4, 3),
(186764, 'Cheruiyot, Jepkemoi Faith', 'Cheruiyot@gmail.com', 5, 3),
(188164, 'Maina, Shatra Wambui', 'Maina.Shatra@gmail.com', 6, 3),
(189254, 'Kamau, Lyeon', 'Kamau@gmail.com', 7, 3),
(189468, 'Chege, Beres Ndungu', 'Chege.Beres@gmail.com', 1, 3),
(189657, 'Mawejje Makumbi, Daudi Kirabo', 'Mawejje@gmail.com', 2, 3),
(191314, 'Makana, Nicholas Tambua', 'Makana@gmail.com', 3, 3),
(191523, 'Kimani, Roy Macharia', 'Kimani@gmail.com', 4, 3),
(192582, 'Namara, Joshua', 'Namara@gmail.com', 5, 3),
(193017, 'Mawira, Roy Mutuma', 'Mawira@gmail.com', 6, 3),
(193285, 'Ahmed, Hussein Abdi', 'Ahmed@gmail.com', 7, 3),
(193384, 'More, Aditya Suhas', 'More@gmail.com', 1, 3),
(193424, 'Maina, Warren Mwangi', 'Maina.Warren@gmail.com', 2, 3);

insert into user_skills (userId, skillId) values
(171407,3),
(171598,34),
(171600,11),
(172445,26);
insert into user_skills (userId, skillId) values
(186764,13),
(188164,24),
(189254,8),
(189468,39),
(189657,1);
insert into user_skills (userId, skillId) values
(191314,4),
(191523,25),
(192582,40),
(193017,32);
insert into user_skills (userId, skillId) values
(193285,39);
insert into user_skills (userId, skillId) values
(193384,40),
(193424,8),
(171407,18),
(171598,3),
(171600,8),
(172445,41),
(186764,37),
(188164,32),
(189254,23),
(189468,3),
(189657,23),
(191314,8),
(191523,20),
(192582,41),
(193017,34),
(193285,10),
(193424,26),
(171407,5),
(171598,9),
(171600,36),
(172445,40),
(188164,2),
(189254,19),
(189468,20),
(189657,33),
(191314,20),
(191523,13),
(192582,37),
(193017,40),
(193285,11),
(193384,16),
(193424,12),
(171407,36),
(171598,40),
(171600,33),
(172445,19),
(186764,36),
(188164,28),
(189254,36),
(189468,34),
(189657,2),
(191314,25),
(191523,37),
(193017,39),
(193285,32),
(193384,1),
(193424,4),
(171407,10),
(171598,38),
(171600,35),
(172445,20),
(186764,15),
(188164,36),
(189254,17),
(189468,27),
(189657,39),
(191314,33),
(191523,19),
(192582,12),
(193017,28),
(193285,20),
(193384,29),
(193424,13),
(171407,6),
(171598,17),
(171600,4),
(172445,39),
(186764,9),
(189254,38),
(189468,15),
(189657,15),
(191314,3),
(191523,2),
(192582,14),
(193017,1),
(193285,16),
(193384,34),
(193424,16),
(171407,34),
(171598,33),
(171600,30),
(186764,1),
(188164,16),
(189254,7),
(189468,30),
(189657,7),
(191314,6),
(191523,21),
(192582,13),
(193017,37),
(193285,7),
(193384,11),
(171407,29),
(171598,30),
(171600,29),
(172445,35),
(186764,11),
(188164,33),
(189254,29),
(189468,18),
(189657,41),
(191523,36),
(192582,25),
(193017,9),
(193285,34),
(193384,28),
(171407,1),
(171598,35),
(171600,17),
(172445,33),
(186764,26),
(189254,1),
(189468,19),
(189657,40),
(191314,30),
(191523,8),
(192582,36),
(193017,33),
(193285,35),
(193384,10),
(193424,14);


SELECT u.fullname, u.email, r.role, g.gender, GROUP_CONCAT(s.skill SEPARATOR ', ') AS skills
FROM users u
LEFT JOIN roles r USING(roleId)
LEFT JOIN gender g USING(genderId)
LEFT JOIN user_skills us USING(userId)
LEFT JOIN skills s USING(skillId)
GROUP BY us.userId
HAVING COUNT(us.userId) > 0
ORDER BY u.fullname;